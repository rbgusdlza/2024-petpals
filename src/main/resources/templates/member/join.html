<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PETPALS: 회원가입</title>

  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <style>
    body {
        min-height: 100vh;
        background-color: #d3d3d3;
    }

    .input-form {
        max-width: 680px;
        margin-top: 80px;
        padding: 32px;
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 8px 20px 0 rgba(0, 0, 0, 0.15);
    }

    .field-error {
        border-color: #bd2130 !important;
        color: #dc3545 !important;
    }

    .error-message {
        color: #dc3545;
        font-size: 0.875em;
    }
  </style>
</head>

<body>
<div class="container">
  <div class="input-form-background row">
    <div class="input-form col-md-12 mx-auto">
      <h4 class="mb-3">PETPALS</h4>
      <form id="signupForm" method="post" novalidate>
        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="id">아이디</label>
            <input type="text" class="form-control" id="id" name="loginId" placeholder="">
            <small class="text-danger error-message" id="idError"></small>
          </div>
          <div class="col-md-6 mb-3">
            <label for="nickname">닉네임</label>
            <input type="text" class="form-control" id="nickname" name="nickname" placeholder="">
            <small class="text-danger error-message" id="nicknameError"></small>
          </div>
        </div>

        <div class="mb-3">
          <label for="password">비밀번호</label>
          <input type="password" class="form-control" id="password" name="password" placeholder="">
          <small class="text-danger error-message" id="passwordError"></small>
        </div>

        <div class="mb-3">
          <label for="email">이메일</label>
          <input type="email" class="form-control" id="email" name="email" placeholder="member@example.com">
          <small class="text-danger error-message" id="emailError"></small>
        </div>

        <hr class="mb-4">
        <div class="custom-control custom-checkbox">
          <input type="checkbox" class="custom-control-input" id="agreement" name="agreement">
          <label class="custom-control-label" for="agreement">개인정보 수집 및 이용에 동의합니다.</label>
          <small class="text-danger error-message" id="agreementError"></small>
        </div>
        <div class="mb-4"></div>
        <button class="btn btn-primary btn-lg btn-block" type="submit">가입 완료</button>
      </form>
    </div>
  </div>
  <footer class="my-3 text-center text-small">
    <p class="mb-1">&copy; 2024 PETPALS</p>
  </footer>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById('signupForm');
    const loginId = document.getElementById('id');
    const nickname = document.getElementById('nickname');
    const password = document.getElementById('password');
    const email = document.getElementById('email');
    const agreement = document.getElementById('agreement');

    const idError = document.getElementById('idError');
    const nicknameError = document.getElementById('nicknameError');
    const passwordError = document.getElementById('passwordError');
    const emailError = document.getElementById('emailError');
    const agreementError = document.getElementById('agreementError');

    const loginIdPattern = /^[a-zA-Z0-9]{5,20}$/;
    const nicknamePattern = /^.{2,10}$/;
    const passwordPattern = /^(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z])(?=.*[@#$%^&+=!])(?=\S+$).{8,16}$/;
    const emailPattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

    function validateInput(input, pattern, errorElement, errorMessageRequired, errorMessagePattern) {
      if (!input.value) {
        input.classList.add('field-error');
        errorElement.textContent = errorMessageRequired;
        return false;
      } else if (!pattern.test(input.value)) {
        input.classList.add('field-error');
        errorElement.textContent = errorMessagePattern;
        return false;
      } else {
        input.classList.remove('field-error');
        errorElement.textContent = '';
        return true;
      }
    }

    loginId.addEventListener('input', function () {
      validateInput(loginId, loginIdPattern, idError, "아이디는 필수입니다.", "아이디는 5~20자의 영문 대/소문자, 숫자만 사용 가능합니다.");
    });

    nickname.addEventListener('input', function () {
      validateInput(nickname, nicknamePattern, nicknameError, "닉네임은 필수입니다.", "닉네임은 2자에서 10자 사이여야 합니다.");
    });

    password.addEventListener('input', function () {
      validateInput(password, passwordPattern, passwordError, "비밀번호는 필수입니다.", "비밀번호는 8~16자의 영문 대/소문자, 숫자, 특수문자가 각각 1개 이상 포함되어야 합니다.");
    });

    email.addEventListener('input', function () {
      validateInput(email, emailPattern, emailError, "이메일은 필수입니다.", "올바르지 않은 형식의 이메일입니다.");
    });

    agreement.addEventListener('change', function () {
      if (!agreement.checked) {
        agreement.classList.add('field-error');
        agreementError.textContent = "가입을 원하시면 약관에 동의해주세요.";
      } else {
        agreement.classList.remove('field-error');
        agreementError.textContent = '';
      }
    });

    form.addEventListener('submit', function (event) {
      const isLoginIdValid = validateInput(loginId, loginIdPattern, idError, "아이디는 필수입니다.", "아이디는 5~20자의 영문 대/소문자, 숫자만 사용 가능합니다.");
      const isNicknameValid = validateInput(nickname, nicknamePattern, nicknameError, "닉네임은 필수입니다.", "닉네임은 2자에서 10자 사이여야 합니다.");
      const isPasswordValid = validateInput(password, passwordPattern, passwordError, "비밀번호는 필수입니다.", "비밀번호는 8~16자의 영문 대/소문자, 숫자, 특수문자가 각각 1개 이상 포함되어야 합니다.");
      const isEmailValid = validateInput(email, emailPattern, emailError, "이메일은 필수입니다.", "올바르지 않은 형식의 이메일입니다.");
      const isAgreementValid = agreement.checked;

      if (!isAgreementValid) {
        agreement.classList.add('field-error');
        agreementError.textContent = "가입을 원하시면 약관에 동의해주세요.";
      }

      if (!isLoginIdValid || !isNicknameValid || !isPasswordValid || !isEmailValid || !isAgreementValid) {
        event.preventDefault();
      }
    });
  });
</script>
</body>
</html>
